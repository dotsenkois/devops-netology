# Домашнее задание к занятию "4.1. Командная оболочка Bash: Практические навыки"

## Обязательные задания

1. Есть скрипт:
	```bash
	a=1
	b=2
	c=a+b
	d=$a+$b
	e=$(($a+$b))
	```
	* Какие значения переменным c,d,e будут присвоены?
	c=a+b d=1+2 e=3
	
	* Почему?
	a+b - строка
	$a+$b - строка "содержимое переменной a" + "содержимое переменной b"
	$(($a+$b)) - сложение значений перменных производится внутри неименованой переменной, содержимое которой и присваевается переменной e.
	

2. На нашем локальном сервере упал сервис и мы написали скрипт, который постоянно проверяет его доступность, записывая дату проверок до тех пор, пока сервис не станет доступным. В скрипте допущена ошибка, из-за которой выполнение не может завершиться, при этом место на Жёстком Диске постоянно уменьшается. Что необходимо сделать, чтобы его исправить:

```bash
    while ((1==1)
    do
    curl https://localhost:4757
    if (($? != 0))
    then
    date >> curl.log
    fi
    done
 
    

#!/bin/bash
while ((1==1))
do
curl https://localhost:4757
if (($? != 0))
then
date >> curl.log
else
exit 0
fi
done
```

3. Необходимо написать скрипт, который проверяет доступность трёх IP: 192.168.0.1, 173.194.222.113, 87.250.250.242 по 80 порту и записывает результат в файл log. Проверять доступность необходимо пять раз для каждого узла.
```bash
#!/bin/bash
ip=('192.168.0.1' '173.194.222.113' '87.250.250.242')
port=80
date >tnc.log
for host in ${ip[@]}
do
  for ((i=0;i<5;i++))
  do
    timeout 1 bash -c "echo >/dev/tcp/$host/$port"
    if [[ $? -eq 0 ]]
    then
      echo "Порт $port  сайта $host открыт" >> tnc.log
    else
      echo "Порт $port сайта $host недоступен" >> tnc.log
    fi
  done
done
```
4. Необходимо дописать скрипт из предыдущего задания так, чтобы он выполнялся до тех пор, пока один из узлов не окажется недоступным. Если любой из узлов недоступен - IP этого узла пишется в файл error, скрипт прерывается

```bash
#!/bin/bash
ip=('192.168.0.1' '173.194.222.113' '87.250.250.242')
port=80
availability=0
while [ 1==1 ]
do
  for host in ${ip[@]}
  do
    for ((i=0;i<5;i++))
    do
      timeout 1 bash -c "echo >/dev/tcp/$host/$port"
      if [ $? == 124 ]
      then
      echo $host 'недоступен' > error.log
      exit 0
      fi
    done
  done
done
```
## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Мы хотим, чтобы у нас были красивые сообщения для коммитов в репозиторий. Для этого нужно написать локальный хук для git, который будет проверять, что сообщение в коммите содержит код текущего задания в квадратных скобках и количество символов в сообщении не превышает 30. Пример сообщения: \[04-script-01-bash\] сломал хук.

